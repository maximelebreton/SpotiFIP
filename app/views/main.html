<div class="row marketing">

    <div class="row">

        <div class="col-xs-6 col-md-6" ng-controller="DatepickerCtrl">

            <p class="input-group">
                <input type="text" ng-change="changed()" class="form-control" datepicker-popup="longDate" ng-model="dt" is-open="opened" datepicker-options="dateOptions" min="minDate" max="maxDate" ng-required="true" close-text="Close" />
                <span class="input-group-btn">
                    <button class="btn btn-default" ng-click="open($event)"><i class="glyphicon glyphicon-calendar"></i>
                    </button>
                </span>
            </p>
        </div>


        <div class="col-xs-6 col-md-3 text-center" style="margin-top:-37px;" ng-controller="TimepickerCtrl">
            <div style="display: inline-block;">
                <timepicker ng-model="mytime" ng-change="changed()" hour-step="hstep" minute-step="mstep" show-meridian="false"></timepicker>
            </div>
        </div>

        <div class="col-xs-12 col-md-3">
            <button ng-click="start()" class="btn btn-md btn-primary btn-block">Rechercher</button>
        </div>

    </div>


    <div ng-show="loading">
        <progressbar class="progress-striped active" value="loadingValue" type="{{loadingType}}">{{loadingMessage}}
        </progressbar>
    </div>
    
    <div ng-if="noResults" class="well well-md text-center">Aucun résultat <a href="http://www.fipradio.fr/archives-antenne?start_date={{startDate}}&start_hour={{startHour}}&search=">sur FIP</a>... Veuillez vérifier la date et l'heure, puis recommencez !</div>

    <div ng-show="ready">

        <div class="well well-md text-center"><a href="http://www.fipradio.fr/archives-antenne?start_date={{startDate}}&start_hour={{startHour}}&search=">{{fipDatas.length}} titres</a> ont été trouvés sur <strong>FIP</strong>, et {{playlist.length}} sont disponibles sur <strong>Spotify</strong></div>

        <table class="table table-hover">
            <thead>
                <tr>
                    <th>Fip</th>
                    <th></th>
                    <th></th>
                    <th>Spotify</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="fip in fipDatas" on-finish-render="test">
                    <td>{{fip.time}}</td>

                    <td>
                        <div class="media">
                            <a class="pull-left">
                                <img class="media-object" ng-src="{{fip.img.src}}" alt="">
                            </a>
                            <div class="media-body small">
                                <ul class="list-group">
                                    <li class="list-group-item small" title="Titre">
                                        <strong>{{fip.track}}</strong>
                                    </li>
                                    <li class="list-group-item small" title="Artiste">{{fip.artist}}</li>
                                    <li class="list-group-item small" title="Album / Année de sortie">
                                        <em>{{fip.album}}</em> {{fip.release}}</li>
                                </ul>
                            </div>
                        </div>
                    </td>

                    <td></td>

                    <td>
                        <iframe ng-src="{{fip.spotify.trackEmbedSrc}}" width="300" height="80" frameborder="0" allowtransparency="true"></iframe>
                        <!--<dl>
                          <dd ng-repeat="artist in fip.spotify.artists">{{artist.name}}</dd>
                          <dd>{{fip.spotify.album.name}}</dd>
                          <dd>{{fip.spotify.name}}</dd>
                          <dd>{{fip.spotify.id}}</dd>
                          <dd>{{fip.spotify.album.released}}</dd>
                      </dl>-->
                    </td>

                </tr>
            </tbody>
        </table>
        
        <hr>

        <h4>Écoutez la playlist</h4>
        <p></p>
        <iframe ng-if="ready" ng-src="{{playlistHref}}" frameborder="0" width="100%" height="640" allowtransparency="true"></iframe>
        
        <hr>

        <h4>Ajoutez cette playlist à Spotify</h4>
        <p>Copiez / collez simplement cette portion de code dans une playlist Spotify</p>
        <div class="form-control" style="height:auto!important;">
          <div ng-repeat="track in playlist">
            {{track}}
          </div>
        </div>

    </div>

</div>
